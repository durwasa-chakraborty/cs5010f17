<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="UTF-8">
<meta name="description" content="Northeastern University CS 5010">
<meta name="author" content="William D Clinger">
<!-- meta name="keywords" content="software" -->

<title>
  The hashCode Method
</title>

<link type="text/css"
      rel="stylesheet"
      href="cs5010.css" />

</head>

<body>

<!-- start of specific content -->

<div id="maincontent">
  <h3>
    The <code>hashCode</code> Method
  </h3>
  <div>
    <p>
      The <code>equals</code> method is indifferent to the order
      in which keys are generated, so the <code>hashCode</code>
      method needs to be independent of that order as well.
    </p>
    <pre>
          // The hash code of an unsorted map cannot depend on the order
          // in which keys are generated by the iterator, so we can't
          // cut this computation off early.
      
          public int hashCode () {
              Iterator&lt;K&gt; it = keyIterator();
              int result = 434937289;
              while (it.hasNext()) {
                  K key = it.next();
                  V val = getVal (key);
                  int keyHash = key.hashCode();
                  int valHash = val.hashCode();
                  result = result + 1232250328 * keyHash - 1436654170 * valHash;
              }
              return result;
          }
    </pre>
    <p>
      In Java, as in many programming languages, integer arithmetic
      is performed modulo 2<sup>32</sup> (for <code>int</code>)
      or 2<sup>64</sup> (for <code>long</code>), with half of the
      values regarded as negative, one of them as zero, and the
      rest as positive.
      The fact that arithmetic overflows can occur in the computation
      of a map's hash code does not matter; sometimes, as here, it may
      even improve the quality of the <code>hashCode</code> method.
    </p>
    <p>
      The three magic numbers in that definition were selected
      at random, used only within that definition, and aren't
      really magic (because another trio of randomly selected
      numbers would probably do just about as well, if not better).
    </p>
    <p>
      Defining symbolic constants with those numeric values
      would not help to maintain consistency or ease of maintenance
      (because those numbers are, by design, used only here).
      Defining them as symbolic constants might even make matters
      worse, by giving readers of the code an impression that
      those constants are intended for use outside of the
      <code>hashCode</code> method.
    </p>
    <p>
      That is not to say this is a good <code>hashCode</code>
      method.  It is easy to see that all non-empty maps will
      have an odd hash code.
      That could be fixed by using odd numbers, preferably
      primes, for at least one of the multiplicative constants.
    </p>
  </div>
</div>
<div id="footer">
  <form action="caseStudy2IMapBase11.html" class="inline">
    <input type="submit" value="PREV">
  </form>
  <br />
  <form action="caseStudy2IMapBase13.html" class="inline">
    <input type="submit" value="NEXT">
  </form>
</div>

<!-- end of specific content -->

<p class="muchsmaller">
For debugging: 
<a href="http://validator.w3.org/check/referer">
Click here to validate.
</a>
</p>

</body>
</html>
